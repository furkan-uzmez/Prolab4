<!DOCTYPE html>
<html lang="tr" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Toplu TaÅŸÄ±ma DuraklarÄ± HaritasÄ±</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet" th:href="@{https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap}">
    <link href="https://fonts.googleapis.com/css2?family=Sen:wght@400;700;800&display=swap" rel="stylesheet" th:href="@{https://fonts.googleapis.com/css2?family=Sen:wght@400;700;800&display=swap}">
    <link rel="stylesheet" th:href="@{/css/style.css}">
</head>
<body>
<div class="top-bar">
    <h1>ğŸ“ Toplu TaÅŸÄ±ma DuraklarÄ±</h1>
    <div class="search-bar">
        <div class="search-container">
            <input type="text" id="searchInput" placeholder="Lokasyon ara (Ã¶rn: Ä°stanbul)">
            <span class="search-icon" id="searchButton">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <circle cx="11" cy="11" r="8"></circle>
                    <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                </svg>
            </span>
        </div>
        <div class="tooltip">Konumu Haritada Ara</div>
    </div>
    <div class="top-bar-controls">
        <button class="control-btn" id="modeToggle" title="KaranlÄ±k Mod">â˜€</button>
        <div class="tooltip">KaranlÄ±k/AÃ§Ä±k Mod</div>
        <button class="control-btn" id="resetMap" title="HaritayÄ± SÄ±fÄ±rla">âŸ³</button>
        <div class="tooltip">HaritayÄ± SÄ±fÄ±rla</div>
        <button class="control-btn" id="getLocation" title="Konumumu Bul">ğŸ“</button>
        <div class="tooltip">Konumumu Bul</div>
    </div>
</div>

<div class="container">
    <div class="form-container">
        <div class="form-control-panel">
            <!-- Konum Bilgileri (Location Info) -->
            <button class="tab-btn active" data-tab="location-tab" title="Konum Bilgileri">
                <svg width="32" height="32" viewBox="0 0 24 24" fill="#3498db" stroke="#ffffff" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                    <!-- Enhanced map-pin with additional details -->
                    <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
                    <circle cx="12" cy="10" r="3"></circle>
                    <path d="M12 7v3" stroke-width="2" stroke="#ffffff"></path> <!-- Vertical line inside pin -->
                    <circle cx="12" cy="10" r="1" fill="#ffffff"></circle> <!-- Smaller inner circle -->
                </svg>
            </button>
            <!-- Ã–deme Bilgileri (Payment Info) -->
            <button class="tab-btn" data-tab="payment-tab" title="Ã–deme Bilgileri">
                <svg width="32" height="32" viewBox="0 0 24 24" fill="#e74c3c" stroke="#ffffff" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                    <!-- Enhanced credit-card with chip and number details -->
                    <rect x="1" y="4" width="22" height="16" rx="2" ry="2"></rect>
                    <line x1="1" y1="10" x2="23" y2="10"></line>
                    <rect x="3" y="6" width="4" height="2" fill="#ffffff"></rect> <!-- Chip -->
                    <line x1="10" y1="14" x2="16" y2="14" stroke-width="1" stroke="#ffffff"></line> <!-- Card number line 1 -->
                    <line x1="10" y1="16" x2="14" y2="16" stroke-width="1" stroke="#ffffff"></line> <!-- Card number line 2 -->
                </svg>
            </button>
            <!-- AraÃ§lar (Tools) -->
            <button class="tab-btn" data-tab="tools-tab" title="AraÃ§lar">
                <svg width="32" height="32" viewBox="0 0 24 24" fill="#2ecc71" stroke="#ffffff" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                    <!-- Enhanced tool with wrench and gear details -->
                    <path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"></path>
                    <circle cx="4" cy="20" r="1" fill="#ffffff"></circle> <!-- Bolt head -->
                    <path d="M16 8l2-2" stroke-width="1" stroke="#ffffff"></path> <!-- Extra wrench detail -->
                </svg>
            </button>
        </div>




        <!-- Sekme Ä°Ã§erikleri -->
        <div class="tab-content">
            <!-- Konum Sekmesi -->
            <div id="location-tab" class="tab-pane active">
                <h2>Konum Bilgileri</h2>
                <form method="POST" id="locationForm" th:action="@{/}" >
                    <div class="input-group">
                        <label for="baslangic_enlem">BaÅŸlangÄ±Ã§ Enlemi:</label>
                        <input type="text" name="baslangic_enlem" id="baslangic_enlem" placeholder="Ã–rn: 40.7669" required>
                    </div>
                    <div class="input-group">
                        <label for="baslangic_boylam">BaÅŸlangÄ±Ã§ BoylamÄ±:</label>
                        <input type="text" name="baslangic_boylam" id="baslangic_boylam" placeholder="Ã–rn: 29.9169" required>
                    </div>
                    <div class="input-group">
                        <label for="hedef_enlem">Hedef Enlemi:</label>
                        <input type="text" name="hedef_enlem" id="hedef_enlem" placeholder="Ã–rn: 40.7769" required>
                    </div>
                    <div class="input-group">
                        <label for="hedef_boylam">Hedef BoylamÄ±:</label>
                        <input type="text" name="hedef_boylam" id="hedef_boylam" placeholder="Ã–rn: 29.9269" required>
                    </div>
                    <div class="form-btn-wrapper">
                        <button type="submit" class="form-btn"><span>KonumlarÄ± GÃ¶ster</span><div class="spinner"></div></button>
                        <div class="tooltip">KonumlarÄ± Haritada GÃ¶ster</div>
                    </div>
                    <div th:if="${hata}" class="error" th:text="${hata}"></div>

                    <!-- Koordinat GÃ¶sterimi -->
                    <div class="coordinate-display">
                        <p>TÄ±klayarak Konum SeÃ§:</p>
                        <p>SeÃ§ilen: <span id="selected-coordinates">HenÃ¼z seÃ§ilmedi</span></p>
                        <div class="quick-actions">
                            <div class="quick-btn-wrapper">
                                <button class="quick-btn" id="set-start">BaÅŸlangÄ±Ã§ Yap</button>
                                <div class="tooltip">SeÃ§ileni BaÅŸlangÄ±Ã§ Olarak Ayarla</div>
                            </div>
                            <div class="quick-btn-wrapper">
                                <button class="quick-btn" id="set-destination">Hedef Yap</button>
                                <div class="tooltip">SeÃ§ileni Hedef Olarak Ayarla</div>
                            </div>
                        </div>
                    </div>

                    <!-- Durak TÃ¼rleri Legend -->
                    <div class="legend">
                        <h3>Durak TÃ¼rleri</h3>
                        <div class="legend-item">
                            <img src="https://img.icons8.com/color/48/000000/bus.png" alt="OtobÃ¼s" class="legend-icon" th:src="@{https://img.icons8.com/color/48/000000/bus.png}">
                            OtobÃ¼s DuraÄŸÄ±
                        </div>
                        <div class="legend-item">
                            <img src="https://img.icons8.com/color/48/000000/tram.png" alt="Tramvay" class="legend-icon" th:src="@{https://img.icons8.com/color/48/000000/tram.png}">
                            Tramvay DuraÄŸÄ±
                        </div>
                    </div>
            </div>

            <!-- Ã–deme Sekmesi -->
            <div id="payment-tab" class="tab-pane">
                <h2>Ã–deme Bilgileri</h2>
                <form id="paymentForm">
                    <div class="input-group" style="margin-bottom: 25px;">
                        <label for="odeme_yontemi">Ã–deme YÃ¶ntemi:</label>
                        <select name="odeme_yontemi" id="odeme_yontemi" required>
                            <option value="" disabled selected>Ã–deme yÃ¶ntemi seÃ§in</option>
                            <option value="nakit">Nakit</option>
                            <option value="kredikart">Kredi KartÄ±</option>
                            <option value="kentkart">Kentkart</option>
                        </select>
                    </div>
                    <div class="input-group" style="margin-bottom: 25px;">
                        <label for="yolcu_turu">Yolcu TÃ¼rÃ¼:</label>
                        <select name="yolcu_turu" id="yolcu_turu" required>
                            <option value="" disabled selected>Yolcu tÃ¼rÃ¼nÃ¼ seÃ§in</option>
                            <option value="genel">Genel</option>
                            <option value="ogrenci">Ã–ÄŸrenci</option>
                            <option value="yasli">YaÅŸlÄ±</option>
                        </select>
                    </div>
                    <div class="input-group" style="margin-bottom: 25px;">
                        <label for="bakiye">Bakiye:</label>
                        <input type="text" name="bakiye" id="bakiye" th:value="${bakiye}" placeholder="Ã–rn: 1000.50" required>
                    </div>
                </form>
            </div>

            <!-- AraÃ§lar Sekmesi -->
            <div id="tools-tab" class="tab-pane">
                <h2>AraÃ§lar</h2>
                <div class="quick-actions">
                    <div class="quick-btn-wrapper">
                        <button class="quick-btn" id="zoomIn">YakÄ±nlaÅŸtÄ±r</button>
                        <div class="tooltip">HaritayÄ± YakÄ±nlaÅŸtÄ±r</div>
                    </div>
                    <div class="quick-btn-wrapper">
                        <button class="quick-btn" id="zoomOut">UzaklaÅŸtÄ±r</button>
                        <div class="tooltip">HaritayÄ± UzaklaÅŸtÄ±r</div>
                    </div>
                    <div class="quick-btn-wrapper">
                        <button class="quick-btn" id="clearMarkers">Ä°ÅŸaretleri Temizle</button>
                        <div class="tooltip">TÃ¼m Ä°ÅŸaretleri KaldÄ±r</div>
                    </div>
                    <div class="quick-btn-wrapper">
                        <button class="quick-btn" id="filter-bus">Sadece OtobÃ¼s</button>
                        <div class="tooltip">YalnÄ±zca OtobÃ¼s DuraklarÄ±nÄ± GÃ¶ster</div>
                    </div>
                    <div class="quick-btn-wrapper">
                        <button class="quick-btn" id="filter-tram">Sadece Tramvay</button>
                        <div class="tooltip">YalnÄ±zca Tramvay DuraklarÄ±nÄ± GÃ¶ster</div>
                    </div>
                    <div class="quick-btn-wrapper">
                        <button class="quick-btn" id="filter-all">TÃ¼m Duraklar</button>
                        <div class="tooltip">TÃ¼m DuraklarÄ± GÃ¶ster</div>
                    </div>
                    <div class="quick-btn-wrapper">
                        <button class="quick-btn" id="saveRoute">RotayÄ± Kaydet</button>
                        <div class="tooltip">Mevcut RotayÄ± Kaydet</div>
                    </div>

                    <div class="route-controls">
                        <button class="quick-btn" id="show-route-1">Rota 1</button>
                        <div class="tooltip">1. RotayÄ± gÃ¶ster</div>
                    </div>
                    <div class="route-controls">
                        <button class="quick-btn" id="show-route-2">Rota 2</button>
                        <div class="tooltip">2. RotayÄ± gÃ¶ster</div>
                    </div>
                    <div class="route-controls">
                        <button class="quick-btn" id="show-route-3">Rota 3</button>
                        <div class="tooltip">3. RotayÄ± gÃ¶ster</div>
                    </div>
                    <div class="route-controls">
                        <button class="quick-btn" id="show-taxi-route">Taksi RotasÄ±</button>
                        <div class="tooltip">Taksi rotasÄ±nÄ± gÃ¶ster</div>
                    </div>
                    <div class="route-controls">
                        <button class="quick-btn" id="show-all-routes">TÃ¼m Rotalar</button>
                        <div class="tooltip">TÃ¼m rotalarÄ± gÃ¶ster</div>
                    </div>


                </div>

            </div>
        </div>

        <!-- Durum Ã‡ubuÄŸu -->
        <div class="status-bar" id="status-bar">
            Durum: Harita YÃ¼klendi
        </div>

        <!-- Tema Bilgisi -->
        <div class="theme-toggle-info" id="theme-info">
            Tema: AÃ§Ä±k Mod
        </div>
    </div>

    </form>

    <!-- Harita AlanÄ± -->
    <div class="map-container">
        <div id="map"></div>
    </div>
</div>

<div class="info-panel" id="infoPanel">
    <button class="close-btn" id="closeInfoPanel">Ã—</button>
    <h3>Rota Bilgileri</h3>
    <div class="route-info" id="routeInfoContent">
        <!-- Route info will be dynamically inserted here -->
    </div>
</div>


<!-- JavaScript DeÄŸiÅŸkenleri -->
<script th:inline="javascript">
    window.duraklar = /*[[${duraklar}]]*/ [];
    window.googleMapsApiKey = /*[[${googleMapsApiKey}]]*/ null;

    // Hata ayÄ±klama iÃ§in
    console.log("Backend'den gelen deÄŸerler:");
    console.log("durakVerisi:", window.durakVerisi);
    console.log("googleMapsApiKey:", window.googleMapsApiKey);
</script>

<script th:inline="javascript">
    window.durakVerisi = JSON.parse(/*[[${duraklar != null ? duraklar : '[]'}]]*/ '[]');
</script>

<!-- Script DosyalarÄ± -->
<script th:src="@{js/script.js}"></script>
<script th:src="@{https://maps.googleapis.com/maps/api/js(key=${googleMapsApiKey},libraries=geometry,callback=initMap,loading=async)}" async defer></script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'922f6ba26c70c599',t:'MTc0MjQxMzAwNS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script>
</body>
</html>